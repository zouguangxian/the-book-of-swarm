
Swarm规范分为四章。第\ref{spec:convention}章列举了使用cc聋子语言作为伪代码的所有与数据类型、格式和算法相关的约定。
\ref{spec:protocol}(协议)章指定了连接协议:消息格式、序列化和封装是对跨客户端兼容性至关重要的硬性要求。本章受益于\lstinline{protobuf}
%
\footnote{\url{https://developers.google.com/protocol-buffers}}
%
它是一种通用的、与语言无关的、与平台无关的、用于序列化结构化数据的可扩展机制。
关于策略(\ref{spec:strategy})的一章旨在提出推荐的激励一致行为。
api (\ref{spec:api})给出了Swarm高级接口的正式规范。不同的客户端实现将根据标准的API测试套件进行测试。API规范受益于\lstinline{OpenAPI}，%
%
\footnote{\url{https://swagger.io/}}
%
是REST API的API描述格式。

\newpage\phantomsection 
\addcontentsline{toc}{chapter}{List of definitions}
\listoftheorems[ignoreall,show={definition}]

\chapter{数据类型和算法}\label{spec:convention}

\orange{}

\section{内置的原语\statusyellow}\label{spec:format:builtin}
\input{specs/format/builtin.tex}

\section{Bzz address\statusgreen}\label{spec:format:bzzaddress}
\input{specs/format/bzzaddress.tex}

\section{块，加密和寻址\statusyellow}
\subsection{内容处理块\statusgreen}\label{spec:format:chunks}
\input{specs/format/chunks.tex}
\subsection{单所有者块\statusgreen}\label{spec:format:soc}
\input{specs/format/soc.tex}
\subsection{二进制默克尔树哈希\statusyellow}\label{spec:format:bmt}
\input{specs/format/bmt.tex}
\subsection{加密\statusyellow}\label{spec:format:encryption}
\input{specs/format/encryption.tex}

\section{文件，清单和数据结构\statusyellow}\label{spec:format:data-structures}
\subsection{文件和Swarm哈希\statusyellow}\label{spec:format:files}
\input{specs/format/files.tex}
\subsection{体现\statusyellow}\label{spec:format:manifests}
\input{specs/format/manifests.tex}
% \section{Entanglement coding \statusred}\label{spec:format:entanglements}
%\input{specs/format/entanglement.tex}
% composite api, resolver, tags
\input{specs/format/storage.tex}

\section{访问控制\statusgreen}\label{spec:format:access-control}
\input{specs/format/access-control.tex}

\section{PSS \statusyellow}

\subsection{PSS message\statusgreen}
\label{spec:format:pss-messsage}
\input{specs/format/pss.tex}
\subsection{更新通知\statusred}\label{spec:format:update-notifications}
%\input{specs/format/update-notifications.tex}

\subsection{大部分复苏\statusyellow}\label{spec:format:recovery}
\input{specs/format/recovery.tex}

\section{邮票\statusorange}\label{spec:format:postage-stamps}
\input{specs/format/postage-stamps.tex}
% \section{Honey token and multi-chain support}\label{spec:format:honey}
%\input{specs/format/honey.tex}


\chapter{协议}\label{spec:protocol}

\section{介绍\statusorange}\label{spec:protocol:intro}
\input{specs/protocol/protocols.tex}

% \section{Swarm protocol basics\statusgreen}\label{spec:protocol:basics}
\section{Bzz握手协议}\label{spec:protocol:bzz}
\input{specs/protocol/bzz.tex}

\section{蜂巢发现\statusgreen}\label{spec:protocol:hive}
\input{specs/protocol/hive.tex}

\section{检索\statusorange}\label{spec:protocol:retrieval}
\input{specs/protocol/retrieval.tex}

\section{Push-syncing \statusorange}\label{spec:protocol:push-sync}
\input{specs/protocol/push-sync.tex}

\section{Pull-syncing \statusorange}\label{spec:protocol:pull-sync}
\input{specs/protocol/pull-sync.tex}

\section{SWAP结算协议\statusorange}\label{spec:protocol:swap}


\chapter{策略\statusorange}\label{spec:strategy}


客户遵循的策略将对网络的行为产生根本性的影响，如果他们最终违背了预先的设计，项目很可能无法满足用户的期望。这样的场景很容易对项目造成致命的影响，这就是为什么在改变(或最初建议)节点行为策略时，宁可谨慎行事。
策略的范围被定义为预期的“方案”中不能直接观察或容易验证的那些方面。举个例子，将转发传入的检索请求(策略)与使用正确格式化和序列化的消息(协议约束)进行对比。后者可以立即被发现，并通过断开连接和列入黑名单的方式做出回应。相比之下，一个节点是否以有利于预期网络结果的方式进行转发是很难检测的。 

由于我们选择使用利润最大化节点操作符这一最狭窄的可能假设，策略的选择应该具有足够的过程粒度，以评估选项的结果。特别是，我们不能考虑到即使是对推荐策略的模糊理性偏差也会产生灾难性影响的情况。

一般来说，应制定激励措施，以确保有害于服务的行为会导致随后损失的风险、威慑预付费用或造成相互的脆弱性。 

在使博弈论对模拟和实验可行或用足够简单的分析模型来帮助推理方面，对策略选择施加的约束是至关重要的。 

\section{连接\statusorange}\label{spec:strategy:connection}
\input{specs/strategy/connection.tex}

\section{转发\statusorange}\label{spec:strategy:forwarding}
\input{specs/strategy/forwarding.tex}

%peer selection and pricing
\section{定价\statusorange}\label{spec:strategy:pricing}
\input{specs/strategy/pricing-retrieval.tex}

\section{会计和结算}\label{spec:strategy:swap}
\input{specs/strategy/swap.tex}

\section{Push-syncing \statusorange}\label{spec:strategy:push-sync}
\input{specs/strategy/push-sync.tex}

\section{Pull-syncing \statusorange}\label{spec:strategy:pull-sync}
\input{specs/strategy/pull-sync.tex}

\section{垃圾收集\statusorange}\label{spec:strategy:garbage-collection}
\input{specs/strategy/garbage-collection.tex}

\chapter{API-s}\label{spec:api}


\begin{definition}[HTTP status codes used in Swarm]
\begin{lstlisting}
\end{lstlisting}
\begin{tabular}{l|p{0.25\linewidth}|p{0.6\linewidth}}
103 & Checkpoint & returns temporary root hash for resumable uploads
\\\hline
200 & ok &
\\
201 & Created & returned by POST requests upon successful creation of file/manifest/tag/stamp/
% \\
% 206 & Partial Content &
\\\hline
400 & Bad request & returned if request or its parameters are not well formed or missing
\\
401 & Unauthorized & returned by access control if auth fails
\\
402$^{*}$ & Payment Required & returned if no swap balance or missing/invalid postage stamp
\\
403 & Forbidden & returned if retrieved chunk is encrypted  but the reference has no decryption key
\\     
404 & Not Found &
returned if a local prerequisite is not found or manifest path does not exist.
\\
405$^{*}$& Method Not Allowed & HTTP verb  not allowed for this endpoint
\\
406$^{*}$
%
& Not Acceptable & No format acceptable by the {ACCEPT} header explicit in the request. 
\\
408 & Request Timeout & Retrieve requests fallback error after TTL passed
\\
% 411 & Length Required & returned by chunk upload API if length of file uploaded is beyond limit
% 412 & Precondition Failed (RFC 7232)
% \\
413 & Payload Too Large  &
Payload size exceeds maximum chunk size or span given (chunk API)
\\
414 & URI Too Long  & manifest path  $>32 $
\\
416 & Range Not Satisfiable  & offset in range query out of range
\\
420 & Enhance your calm & returned when recovery was initiated but retrieval timed out
\\
422 & Unprocessable Entity & returned by the blockchain external API if eth api returns an error or by single owner chunk post API if owner/id pair already exists
% 417 & Expectation Failed
% 421 & Misdirected Request (RFC 7540)
% 451 & Unavailable For Legal Reasons (RFC 7725)
\end{tabular}

\footnotesize{$^{*}$Generic errors detectable before endpoint API call so not documented.}
\end{definition}


\section{外部API requirements\statusorange}\label{spec:api:external}
\input{specs/api/external.tex}


\section{存储API \statusyellow}\label{spec:api:storage}
\input{specs/api/storage.tex}


\subsection{标签\statusyellow}\label{spec:api:tags}
\input{specs/api/tags.tex}

\subsection{锁住
\statusyellow}\label{spec:api:pinning}
\input{specs/api/pinning.tex}

\subsection{交换和chequebook\statusorange}\label{spec:api:swap}
\input{specs/api/swap.tex}

\subsection{邮票\statusorange}\label{spec:api:postage}
\input{specs/api/postage.tex}


\subsection{访问控制\statusgreen}\label{spec:api:access-control}
\input{specs/api/access-control.tex}


% \subsection{Recovery\statusorange}\label{spec:api:recovery}

\section{通信\statusorange}\label{spec:api:communications}
\input{specs/api/comms.tex}

\subsection{PSS \statusyellow}\label{spec:api:trojan}
\input{specs/api/pss.tex}


\subsection{提要\statusorange}\label{spec:api:feeds}



% \subsection{The pss URL scheme}


